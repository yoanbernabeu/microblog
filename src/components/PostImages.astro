---
interface Props {
  images: Array<{
    src: string;
    alt?: string;
  }>;
}

const { images } = Astro.props;
const baseUrl = import.meta.env.BASE_URL;

// Grille adaptative selon le nombre d'images - taille reduite
const getGridClass = (count: number): string => {
  switch (count) {
    case 1:
      return 'grid-cols-1 max-w-xs';
    case 2:
      return 'grid-cols-2 max-w-sm';
    case 3:
      return 'grid-cols-3 max-w-md';
    case 4:
      return 'grid-cols-2 max-w-sm';
    default:
      return 'grid-cols-2 max-w-sm';
  }
};

const gridClass = getGridClass(images.length);
---

{images.length > 0 && (
  <div class={`mt-4 grid ${gridClass} gap-1.5 rounded-xl overflow-hidden`}>
    {images.map((image, index) => {
      const imageSrc = image.src.startsWith('/') ? `${baseUrl}${image.src}` : image.src;

      return (
        <button
          type="button"
          class="relative overflow-hidden bg-surface-100 dark:bg-surface-800 rounded-lg group/img aspect-square cursor-zoom-in"
          data-lightbox-src={imageSrc}
          data-lightbox-alt={image.alt || ''}
          aria-label={image.alt || `Agrandir image ${index + 1}`}
        >
          <img
            src={imageSrc}
            alt={image.alt || ''}
            class="w-full h-full object-cover group-hover/img:scale-105 transition-transform duration-300"
            loading="lazy"
          />
          <div class="absolute inset-0 bg-black/0 group-hover/img:bg-black/10 transition-colors duration-300 flex items-center justify-center">
            <svg class="w-6 h-6 text-white opacity-0 group-hover/img:opacity-100 transition-opacity duration-300 drop-shadow-lg" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7" />
            </svg>
          </div>
        </button>
      );
    })}
  </div>
)}
